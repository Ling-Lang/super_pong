pico-8 cartridge // http://www.pico-8.com
version 38
__lua__
--init
#include objects.lua
#include draw_sprites.lua
#include movement.lua
#include events.lua
function _init()
	cls(0)
	print(player.speed, 20, 20, 4)
	
			--animation
	
			particles = {}
			hearts = {}
	
			--particles
	
			particle1 = {
			sprite = 100,
			timing = 0.15,
			x = 0
			}

			particle2 = {
			sprite = 100,
			timing = 0.13,
			x = 16
			}

			particle3 = {
			sprite = 100,
			timing = 0.15,
			x = 32
			}

			particle4 = {
			sprite = 100,
			timing = 0.13,
			x = 48
			}

			particle5 = {
			sprite = 100,
			timing = 0.15,
			x = 64
			} 

			particle6 = {
			sprite = 100,
			timing = 0.13,
			x = 80
			}

			particle7 = {
			sprite = 100,
			timing = 0.15,
			x = 96
			}

			particle8 = {
			sprite = 100,
			timing = 0.13,
			x = 112
			}

			add(particles,particle1)
			add(particles,particle2)
			add(particles,particle3)
			add(particles,particle4)
			add(particles,particle5)
			add(particles,particle6)
			add(particles,particle7)
			add(particles,particle8)
			
			--hearts
			
			heart1 = {
			sprite = 32,
			timing = 0.13,
			x = 0
			}
			
			heart2 = {
			sprite = 32,
			timing = 0.13,
			x = 17
			}
			
			heart3 = {
			sprite = 32,
			timing = 0.13,
			x = 34
			}
			
			add(hearts,heart1)
			add(hearts,heart2)
			add(hearts,heart3)
			
end

-->8
--update

function _draw()
	if player.health > 0 then
		game_over()
 	cls(0)
		dsprite()
		hs()
	
				--animation
			
				--particles
			
				for particle in all(particles) do
				spr(particle.sprite,particle.x,112,2,2) end
			
				--hearts
				for heart in all(hearts) do
				spr(heart.sprite,heart.x,112,2,2)  end
	elseif player.health <= 0 then
		game_over()
	end
end

function _update()
	move()
	eai()
	update_posi()
	hit()
	player.speed=0
	
	abil()

				--animation
				
				--particles

				for particle in all(particles) do
				particle.sprite += particle.timing
				if particle.sprite > 106 then particle.sprite = 100 end	
				end
				
				--hearts
				
				for heart in all(hearts) do
				--heart.sprite += heart.timing
				heart.sprite += 2
				if heart.sprite > 36 then heart.sprite = 32 end	
				end
	
end
__gfx__
00000000700000000700000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000670000007600000000000000000000000000000000000000077777777777777007777777777777700777777777777770077777777777777000000000
00700700670000007600000000077000000220000001100000088000070000000000007007000000000000700700000000000070070000000000007000000000
00077000670000007600000000766700002ef200001c7100008f9800070000080000007007000555555000700700000000000070070033333333007000000000
00077000670000007600000000766700002fe2000017c1000089f80007000088808000700700566666650070070000000000007007003bbbbbb3007000000000
0070070067000000760000000007700000022000000110000008800007000089888000700705666656665070070000000000007007003b3bb3b3007000000000
0000000067000000760000000000000000000000000000000000000007000899989800700705666656665070070006660011007007003bb33bb3007000000000
000000006700000076000000000000000000000000000000000000000700889f9998007007056666566650700700000001c7107007003bb33bb3007000000000
000000006700000076000000000000000000000000000000000000000700899ff9980070070566555666507007066600017c107007003bb33bb3007000000000
00000000670000007600000000000000000000000000000000000000070089ffff9800700705666666665070070000000011007007003b3bb3b3007000000000
000000006700000076000000000000000000000000000000000000000700899fff9800700705666666665070070000666000007007003bbbbbb3007000000000
00000000670000007600000000000000000000000000000000000000070008999988007007005666666500700700000000000070070003bbbb30007000000000
00000000670000007600000000000000000000000000000000000000070000888880007007000555555000700700000000000070070000333300007000000000
00000000700000000700000000000000000000000000000000000000070000000000007007000000000000700700000000000070070000000000007000000000
00000000000000000000000000000000000000000000000000000000077777777777777007777777777777700777777777777770077777777777777000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000008880000008880000000000000000000000000000000000000000000000000000000000000000000000000000000000
00888000000888000000000000000000088e88000088e88000000000000080000000700000000000000000000000000000000000003333000077770000000000
088e88000088e880000888000088800088e8888008888e8800000000000898000007970000222200007777000000000000000000003bb300007bb70000000000
08e8888008888e800088e880088e88008e888888888888e8000000000089980000799700000ef000000ef000001c1c10007c7c70003bb300007bb70000000000
08e8888888888e80008e88888888e8008e888888888888e8000000000089f8000079f700002222000077770001c1c10007c7c700003bb300007bb70000000000
0888888888888e80008888888888e80088888888888888e800000000000880000007700000000000000000000000000000000000003bb300007bb70000000000
0888888888888e800088888888888800888888888888888800000000000000000000000000000000000000000000000000000000000330000007700000000000
00888888888888000008888888888000088888888888888000000000000000000000000000000000000000000000000000000000000000000000000000000000
00888888888888000008888888888000088888888888888000000000000000000000000000000000000000000000000000000000000000000000000000000000
0008888888888000000088888e880000008888888888880000000000000000000000000000000000000000000000000000000000000000000000000000000000
0008888888e8800000008888e888000000888888888e880000000000000000000000000000000000000000000000000000000000000000000000000000000000
000088888e88000000000888888000000008888888e8800000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000888888000000000008888000000000088888e88000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000088880000000000000880000000000008888880000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000008800000000000000000000000000000888800000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000088000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
09999999999999900999999999999990099999999999999009999999999999900999999999999990099999999999999009999999999999900999999999999990
90000000000000099a000000000000099aa00000000000099aaa0000000000099aaaa000000000099aaaaa00000000099aaaaaa0000000099aaaaaaa00000009
09999999999999900999999999999990099999999999999009999999999999900999999999999990099999999999999009999999999999900999999999999990
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
09999999999999900999999999999990099999999999999009999999999999900999999999999990099999999999999009999999999999900999999999999990
9aaaaaaaa00000099aaaaaaaaa0000099aaaaaaaaaa000099aaaaaaaaaaa00099aaaaaaaaaaaa0099aaaaaaaaaaaaa099aaaaaaaaaaaaaa99777777777777779
09999999999999900999999999999990099999999999999009999999999999900999999999999990099999999999999009999999999999900999999999999990
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000060000000000000006000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000a0065000000000000a065000000000000000000000000000000000000000000000000000700000000000000000000000000000000000000000000
000000000000a06500000000000a0065000000000000000000000000000000000000000000000000000000000000070000000000000000000000000000000000
00000000000a0055000000000000a055000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
000000000000a06500000000000a0065000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000a0065000000000000a065000000000000000000000000000000000000007000000000000000000000000000000000000000000000000000000000
000000000000a06500000000000a0065000000000000000000000000000000000000000000000000000000000000007000000000000000000000000000000000
00000000000a0065000000000000a065000000000000000000000000000000000700000000007000000000000000000000000000000000000000000000000000
000000000000a06500000000000a0065000000000000000000000700000000000000000000000000000700000000000000000000000000000000000000000000
00000000000a0065000000000000a065000000000000000000000000000007000000000000000000000000000000000000000000000000000000000000000000
000000000000a05500000000000a0055000000000000000070000000000000000070000000000000000000070000000000000000000000000000000000000000
00000000000a0065000000000000a065000000000000000000000000000000000000000007000000000000000000070055555555555555550000000000000000
000000000000a06500000000000a0065000700000000000000000000000000000000000000000000000000000000000066666666666666660000000000000000
00000000000000060000000000000006000000000000000000070000000000000000000000000070000000000000000066666666666666660000000000000000
00000000000000000000000000000000000000000700000000000000000000000000000000000000000000000000000077777777777777770000000000000000
00000000000000000000000000000000000000000000007000000000007000000000000000000000000000000000000077777777777777770000000000000000
__label__
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000080808880088080800880088008808880888000008080000000000000000000000000000000000000000
00000000000000000000000000000000000000000000080800800800080808000800080808080800008008080000000000000000000000000000000000000000
00000000000000000000000000000000000000000000088800800800088808880800080808800880000008880000000000000000000000000000000000000000
00000000000000000000000000000000000000000000080800800808080800080800080808080800008000080000000000000000000000000000000000000000
00000000000000000000000000000000000000000000080808880888080808800088088008080888000000080000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
70000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000007000000
67000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000076000000
67000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000076000000
67000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000076000000
67000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000076000000
67000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000076000000
67000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000076000000
70000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000007000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000077000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000766700000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000766700000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000077000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000

__gff__
0000000101010100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
